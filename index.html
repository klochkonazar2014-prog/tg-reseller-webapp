<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MRKT</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="lottie.min.js"></script>
    <link rel="stylesheet" href="style.css?v=1.1.80">
</head>

<body>
    <!-- Full Screen Product View -->
    <div id="product-view" class="product-view">
        <div class="product-view-header">
            <button class="back-btn" onclick="closeProductView()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <line x1="19" y1="12" x2="5" y2="12"></line>
                    <polyline points="12 19 5 12 12 5"></polyline>
                </svg>
            </button>
            <span style="font-weight: 700; font-size: 18px;">Предпросмотр</span>
        </div>

        <div class="product-main-media" style="position: relative;">
            <img id="view-img" src="" alt="NFT">
            <div id="view-lottie"
                style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;"></div>
        </div>

        <div class="product-info-section">
            <div class="product-title-row">
                <h1 id="view-title">Name #000</h1>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
            </div>

            <div id="view-collection" class="product-collection-link">Collection ></div>

            <div class="badge-row">
                <div class="market-badge badge-rent">В аренде</div>
                <div class="market-badge badge-app">Marketapp</div>
            </div>

            <div class="pricing-card">
                <div class="pricing-grid">
                    <div>
                        <div class="pricing-label">Цена в день</div>
                        <div id="view-daily-price" class="pricing-value">▼ 0.01</div>
                    </div>
                    <div>
                        <div class="pricing-label">Срок (дни)</div>
                        <div id="view-duration-range" class="pricing-value">1 — 30</div>
                    </div>
                </div>
                <div class="auto-relist-note">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        style="margin-top:2px;">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                    </svg>
                    <span>Авто-продление. Это NFT будет доступно для аренды автоматически после окончания срока.</span>
                </div>
            </div>

            <div class="properties-tabs" style="margin-top: 24px;">
                <div class="tab-item">Свойства</div>
            </div>
            <div id="view-properties" style="margin-bottom: 24px;">
                <!-- Dynamic props here -->
            </div>

            <div class="duration-stepper-row">
                <button class="stepper-btn" onclick="adjustDuration(-1)">−</button>
                <input type="number" id="rent-duration-input" class="stepper-input" value="1" readonly>
                <button class="stepper-btn" onclick="adjustDuration(1)">+</button>
            </div>

            <button id="confirm-pay-btn" class="main-rent-btn" style="display: none;">Арендовать за ▼ 0.01</button>
            <div id="ton-connect-btn" class="ton-btn-wrapper"></div>

            <div class="fee-info-card">
                Вы дополнительно отправите 0.2 TON для обработки транзакции. Остаток TON будет возвращен вам.
                <span style="color:var(--accent-blue)">Что это значит?</span>
            </div>

            <div class="details-section">
                <div class="detail-row">
                    <span class="detail-label">Владелец</span>
                    <span id="view-owner" class="detail-value link">fragment.ton ></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Коллекция</span>
                    <span id="view-col-name" class="detail-value link">Gifts ></span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">NFT адрес</span>
                    <span id="view-address" class="detail-value">EQAmL...SEv</span>
                </div>


                <div class="product-desc-card">
                    <div id="view-desc-title" class="desc-title">Name #000</div>
                    <div class="desc-text">Эксклюзивный подарок от Fragment. Ограниченное издание, доступное для аренды
                        прямо сейчас.</div>
                </div>
            </div>
        </div>
    </div>
    <!-- Premium Loading Screen -->
    <div id="loading-screen">
        <div class="premium-spinner"></div>
        <div style="color: #fff; font-weight: 600; letter-spacing: 1px;">ARENDA</div>
    </div>

    <!-- Header MRKT -->
    <div class="header-column">
        <!-- Search -->
        <div class="search-row">
            <div class="search-wrapper">
                <svg style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #8b9bb4;"
                    width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" id="search-input" class="search-bar" placeholder="Поиск по названию NFT / номеру">
            </div>
            <button class="header-cart-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
            </button>
        </div>

        <!-- Chips -->
        <div class="chips-row">
            <button class="chip-btn icon-only" onclick="openAdvancedFilters()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M4 21v-7m0-4V3m8 18v-9m0-4V3m8 18v-5m0-4V3M1 14h6m2-6h6m2 8h6"></path>
                </svg>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('nft')">
                NFT <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('model')">
                Модель <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('bg')">
                Фон <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('symbol')">
                Символ <span>▼</span>
            </button>
        </div>

        <input type="hidden" id="filter-nft" value="all">
        <input type="hidden" id="filter-sort" value="price_asc">
    </div>

    <!-- Filter Modal (Advanced) -->
    <div id="mrkt-modal-overlay" class="modal-overlay" onclick="closeMrktModal()"></div>
    <div id="mrkt-modal" class="filter-panel">
        <div class="mrkt-modal-header">
            <h3>Фильтры</h3>
            <button onclick="closeMrktModal()"
                style="background:none; border:none; color:#8b9bb4; font-size:24px; cursor: pointer;">✕</button>
        </div>

        <div class="filter-content">
            <!-- Gift Number Section -->
            <div class="filter-section-title">Номер подарка</div>
            <div class="filter-input-row">
                <div class="filter-input-wrapper">
                    <span>#</span>
                    <input type="number" id="filter-gift-number" placeholder="Номер">
                </div>
            </div>

            <!-- Sort Section -->
            <div class="filter-accordion" onclick="toggleAccordion('sort-acc', this)">
                <span>Сортировать по</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="sort-acc" class="accordion-content">
                <div id="sort-list-container" style="padding: 0 20px;"></div>
            </div>

            <!-- Price Section -->
            <div class="filter-accordion" onclick="toggleAccordion('price-acc', this)">
                <span>Цена</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="price-acc" class="accordion-content">
                <div class="filter-input-row" style="padding-top:10px;">
                    <div class="filter-input-wrapper">
                        <span>▼</span>
                        <input type="number" id="filter-price-from" placeholder="От">
                    </div>
                    <div style="color:#555">—</div>
                    <div class="filter-input-wrapper">
                        <input type="number" id="filter-price-to" placeholder="До">
                    </div>
                </div>
            </div>

            <!-- Categories -->
            <div class="filter-accordion" onclick="toggleAccordion('tags-acc', this)">
                <span>Теги</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="tags-acc" class="accordion-content">
                <div id="tags-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('nft-acc', this)">
                <span>NFT</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="nft-acc" class="accordion-content">
                <div id="nft-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('model-acc', this)">
                <span>Модель</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="model-acc" class="accordion-content">
                <div id="model-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('bg-acc', this)">
                <span>Фон</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="bg-acc" class="accordion-content">
                <div id="bg-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('symbol-acc', this)">
                <span>Символ</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="symbol-acc" class="accordion-content">
                <div id="symbol-list-container" style="padding: 0 20px;"></div>
            </div>
        </div>

        <div class="mrkt-footer">
            <button class="btn-gray" onclick="resetMrktModal()">Очистить все</button>
            <button class="btn-yellow" onclick="applyMrktModal()">Показать результаты</button>
        </div>
    </div>

    <!-- Content -->
    <div class="container">
        <!-- Market Tab -->
        <div id="market-container">
            <div id="top-loader" class="loader">Загрузка данных рынка...</div>
            <div id="items-view" class="grid"></div>
            <div id="loader-trigger" style="height: 40px;"></div>
        </div>

        <!-- Orders Tab -->
        <div id="orders-container" style="display: none; padding: 20px; text-align: center; color: #8b9bb4;">
            <h3>Ваши ордеры</h3>
            <p style="margin-top: 10px; font-size: 14px;">У вас пока нет активных аренд.</p>
        </div>

        <!-- Hub Tab -->
        <div id="hub-container" style="display: none; padding: 20px; text-align: center; color: #8b9bb4;">
            <h3>Игровой хаб</h3>
            <p style="margin-top: 10px; font-size: 14px;">Скоро здесь появятся игры!</p>
        </div>

        <!-- Raffle Tab -->
        <div id="raffle-container" style="display: none; padding: 20px; text-align: center; color: #8b9bb4;">
            <h3>Розыгрыши</h3>
            <p style="margin-top: 10px; font-size: 14px;">Активных розыгрышей нет.</p>
        </div>

        <!-- Storage Tab -->
        <div id="storage-container" style="display: none; padding: 20px; text-align: center; color: #8b9bb4;">
            <h3>Хранилище</h3>
            <p style="margin-top: 10px; font-size: 14px;">Ваше хранилище пусто.</p>
        </div>
    </div>

    <!-- Bottom Nav -->
    <div class="bottom-nav">
        <div class="nav-item active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span>Маркет</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M9 11l3 3L22 4"></path>
                <path d="M22 12v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h9"></path>
            </svg>
            <span>Ордеры</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="2" y="6" width="20" height="12" rx="2"></rect>
                <path d="M6 12h.01"></path>
                <path d="M10 12h.01"></path>
                <path d="M15 10l2 2-2 2"></path>
                <path d="M19 12h.01"></path>
            </svg>
            <span>Игровой хаб</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 8v8"></path>
                <path d="M8 12h8"></path>
            </svg>
            <span>Розыгрыши</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            <span>Хранилище</span>
        </div>
    </div>

    <script src="app.js?v=1.1.87"></script>
</body>

</html>