<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>MRKT</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="lottie.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- Header MRKT -->
    <div class="header-column">
        <!-- Search -->
        <div class="search-row">
            <div class="search-wrapper">
                <svg style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); color: #8b9bb4;"
                    width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="text" id="search-input" class="search-bar" placeholder="Поиск по названию NFT / номеру">
            </div>
            <button class="header-cart-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
            </button>
        </div>

        <!-- Chips -->
        <div class="chips-row">
            <button class="chip-btn icon-only" onclick="openAdvancedFilters()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M4 21v-7m0-4V3m8 18v-9m0-4V3m8 18v-5m0-4V3M1 14h6m2-6h6m2 8h6"></path>
                </svg>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('nft')">
                NFT <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('model')">
                Модель <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('bg')">
                Фон <span>▼</span>
            </button>

            <button class="chip-btn" onclick="toggleGenericModal('symbol')">
                Символ <span>▼</span>
            </button>
        </div>

        <input type="hidden" id="filter-nft" value="all">
        <input type="hidden" id="filter-sort" value="price_asc">
    </div>

    <!-- Filter Modal (Advanced) -->
    <div id="mrkt-modal-overlay" class="modal-overlay" onclick="closeMrktModal()"></div>
    <div id="mrkt-modal" class="filter-panel">
        <div class="mrkt-modal-header">
            <h3>Фильтры</h3>
            <button onclick="closeMrktModal()"
                style="background:none; border:none; color:#8b9bb4; font-size:24px; cursor: pointer;">✕</button>
        </div>

        <div class="filter-content">
            <!-- Gift Number Section -->
            <div class="filter-section-title">Номер подарка</div>
            <div class="filter-input-row">
                <div class="filter-input-wrapper">
                    <span>#</span>
                    <input type="number" id="filter-gift-number" placeholder="Номер">
                </div>
            </div>

            <!-- Sort Section -->
            <div class="filter-accordion" onclick="toggleAccordion('sort-acc', this)">
                <span>Сортировать по</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="sort-acc" class="accordion-content">
                <div id="sort-list-container" style="padding: 0 20px;"></div>
            </div>

            <!-- Price Section -->
            <div class="filter-accordion" onclick="toggleAccordion('price-acc', this)">
                <span>Цена</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="price-acc" class="accordion-content">
                <div class="filter-input-row" style="padding-top:10px;">
                    <div class="filter-input-wrapper">
                        <span>▼</span>
                        <input type="number" id="filter-price-from" placeholder="От">
                    </div>
                    <div style="color:#555">—</div>
                    <div class="filter-input-wrapper">
                        <input type="number" id="filter-price-to" placeholder="До">
                    </div>
                </div>
            </div>

            <!-- Categories -->
            <div class="filter-accordion" onclick="toggleAccordion('tags-acc', this)">
                <span>Теги</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="tags-acc" class="accordion-content">
                <div id="tags-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('nft-acc', this)">
                <span>NFT</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="nft-acc" class="accordion-content">
                <div id="nft-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('model-acc', this)">
                <span>Модель</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="model-acc" class="accordion-content">
                <div id="model-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('bg-acc', this)">
                <span>Фон</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="bg-acc" class="accordion-content">
                <div id="bg-list-container" style="padding: 0 20px;"></div>
            </div>

            <div class="filter-accordion" onclick="toggleAccordion('symbol-acc', this)">
                <span>Символ</span>
                <div class="filter-accordion-arrow">▼</div>
            </div>
            <div id="symbol-acc" class="accordion-content">
                <div id="symbol-list-container" style="padding: 0 20px;"></div>
            </div>
        </div>

        <div class="mrkt-footer">
            <button class="btn-gray" onclick="resetMrktModal()">Очистить все</button>
            <button class="btn-yellow" onclick="applyMrktModal()">Показать результаты</button>
        </div>
    </div>

    <!-- Content -->
    <div class="container">
        <div id="top-loader" class="loader">Загрузка данных рынка...</div>
        <div id="items-view" class="grid"></div>
        <div id="loader-trigger" style="height: 40px;"></div>
    </div>

    <!-- Bottom Nav -->
    <div class="bottom-nav">
        <div class="nav-item active">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <path d="M16 10a4 4 0 0 1-8 0"></path>
            </svg>
            <span>Маркет</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M9 11l3 3L22 4"></path>
                <path d="M22 12v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h9"></path>
            </svg>
            <span>Ордеры</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <rect x="2" y="6" width="20" height="12" rx="2"></rect>
                <path d="M6 12h.01"></path>
                <path d="M10 12h.01"></path>
                <path d="M15 10l2 2-2 2"></path>
                <path d="M19 12h.01"></path>
            </svg>
            <span>Игровой хаб</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M12 8v8"></path>
                <path d="M8 12h8"></path>
            </svg>
            <span>Розыгрыши</span>
        </div>
        <div class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
            </svg>
            <span>Хранилище</span>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="payment-modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="modal-img-container" style="text-align: center; margin-bottom: 20px;">
                <img id="modal-img" src="" class="modal-img" style="display:none;">
            </div>
            <h2 id="modal-title" style="margin-bottom: 5px;">NFT</h2>
            <div style="color:#8b9bb4; font-size:14px; margin-bottom:15px;">Аренда за день</div>
            <p class="modal-price"><span id="modal-price">10 TON</span></p>
            <button id="confirm-pay-btn" class="btn-yellow"
                style="width: 100%; margin-bottom: 10px; display: none;">Подтвердить и Оплатить</button>
            <div id="ton-connect-btn" class="ton-btn-wrapper"></div>
        </div>
    </div>

    <script src="app.js?v=1.1.45"></script>
</body>

</html>